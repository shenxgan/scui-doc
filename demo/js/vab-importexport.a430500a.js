"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[9922],{6698:function(e,l,a){a.r(l),a.d(l,{default:function(){return C}});var t=a(641);const o={style:{"margin-top":"15px"}};function i(e,l,a,i,r,s){const n=(0,t.g2)("sc-file-import"),d=(0,t.g2)("el-button"),p=(0,t.g2)("sc-icon-file-excel"),u=(0,t.g2)("el-icon"),c=(0,t.g2)("el-switch"),m=(0,t.g2)("el-form-item"),b=(0,t.g2)("el-descriptions-item"),f=(0,t.g2)("el-descriptions"),g=(0,t.g2)("el-card"),h=(0,t.g2)("el-col"),k=(0,t.g2)("sc-file-export"),y=(0,t.g2)("el-option"),F=(0,t.g2)("el-select"),_=(0,t.g2)("el-row"),w=(0,t.g2)("el-main"),x=(0,t.g2)("el-alert"),D=(0,t.g2)("el-table-column"),v=(0,t.g2)("el-icon-circle-close-filled"),W=(0,t.g2)("el-tag"),C=(0,t.g2)("el-table"),V=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(w,null,{default:(0,t.k6)((()=>[(0,t.bF)(_,{gutter:15},{default:(0,t.k6)((()=>[(0,t.bF)(h,{lg:12},{default:(0,t.k6)((()=>[(0,t.bF)(g,{shadow:"never",header:"导入(使用mock,有50%几率导入失败)"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{apiObj:e.$API.common.importFile,templateUrl:"http://www.scuiadmin/file.xlsx",onSuccess:s.success},null,8,["apiObj","onSuccess"]),(0,t.bF)(n,{apiObj:e.$API.common.importFile,data:{otherData:"demo"},templateUrl:"http://www.scuiadmin/file.xlsx",accept:".xls, .xlsx",maxSize:30,tip:"请上传小于或等于 30M 的 .xls, .xlsx 格式文件(自定义TIP)",onSuccess:s.success},{default:(0,t.k6)((({open:e})=>[(0,t.bF)(d,{type:"primary",icon:"sc-icon-upload",onClick:e},{default:(0,t.k6)((()=>l[3]||(l[3]=[(0,t.eW)("导入(全配置)")]))),_:2},1032,["onClick"])])),uploader:(0,t.k6)((()=>[(0,t.bF)(u,{class:"el-icon--upload"},{default:(0,t.k6)((()=>[(0,t.bF)(p)])),_:1}),l[4]||(l[4]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将文件拖到此处或 "),(0,t.Lk)("em",null,"点击选择文件上传")],-1))])),form:(0,t.k6)((({formData:e})=>[(0,t.bF)(m,{label:"覆盖已有数据"},{default:(0,t.k6)((()=>[(0,t.bF)(c,{modelValue:e.coverage,"onUpdate:modelValue":l=>e.coverage=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,t.bF)(m,{label:"跳过错误数据"},{default:(0,t.k6)((()=>[(0,t.bF)(c,{modelValue:e.skipError,"onUpdate:modelValue":l=>e.skipError=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:1},8,["apiObj","onSuccess"]),(0,t.bF)(f,{column:1,border:"",size:"small",style:{"margin-top":"15px"}},{default:(0,t.k6)((()=>[(0,t.bF)(b,{label:"apiObj",width:200},{default:(0,t.k6)((()=>l[5]||(l[5]=[(0,t.eW)("Object 文件上传接口对象")]))),_:1}),(0,t.bF)(b,{label:"data"},{default:(0,t.k6)((()=>l[6]||(l[6]=[(0,t.eW)("Object 上传时附带的额外参数")]))),_:1}),(0,t.bF)(b,{label:"accept"},{default:(0,t.k6)((()=>l[7]||(l[7]=[(0,t.eW)('String 可选择文件类型，默认为".xls, .xlsx"')]))),_:1}),(0,t.bF)(b,{label:"maxSize"},{default:(0,t.k6)((()=>l[8]||(l[8]=[(0,t.eW)("Number 可选择文件大小，单位为M，默认为10")]))),_:1}),(0,t.bF)(b,{label:"tip"},{default:(0,t.k6)((()=>l[9]||(l[9]=[(0,t.eW)('String 上传框底下的提示语句，默认为"请上传小于或等于 {maxSize}M 的 {accept} 格式文件"')]))),_:1}),(0,t.bF)(b,{label:"templateUrl"},{default:(0,t.k6)((()=>l[10]||(l[10]=[(0,t.eW)("String 模板的下载URL")]))),_:1}),(0,t.bF)(b,{label:"@success"},{default:(0,t.k6)((()=>l[11]||(l[11]=[(0,t.eW)("事件 上传接口返回的事件，返回function(res, close)，执行close()将关闭窗口")]))),_:1}),(0,t.bF)(b,{label:'#default="{open}"'},{default:(0,t.k6)((()=>l[12]||(l[12]=[(0,t.eW)("插糟 默认触发按钮插糟，返回open()打开窗口函数，可以绑定元素@click事件")]))),_:1}),(0,t.bF)(b,{label:"#uploader"},{default:(0,t.k6)((()=>l[13]||(l[13]=[(0,t.eW)("插糟 自定义上传框插槽")]))),_:1}),(0,t.bF)(b,{label:'#form="{formData}"'},{default:(0,t.k6)((()=>l[14]||(l[14]=[(0,t.eW)("插糟 自定义表单组件，插槽formData都将作为上传时附带的额外参数")]))),_:1})])),_:1})])),_:1})])),_:1}),(0,t.bF)(h,{lg:12},{default:(0,t.k6)((()=>[(0,t.bF)(g,{shadow:"never",header:"导出"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{apiObj:e.$API.common.exportFile},null,8,["apiObj"]),(0,t.bF)(k,{apiObj:e.$API.common.exportFile,fileName:"人员列表(异步)",async:""},{default:(0,t.k6)((({open:e})=>[(0,t.bF)(d,{type:"primary",icon:"sc-icon-download",onClick:e},{default:(0,t.k6)((()=>l[15]||(l[15]=[(0,t.eW)("导出(异步)")]))),_:2},1032,["onClick"])])),_:1},8,["apiObj"]),(0,t.bF)(k,{apiObj:e.$API.common.exportFile,blob:"",fileName:"人员列表",data:{otherData:"demo"},showData:"",column:r.column,fileTypes:["xlsx","docx","pdf"]},{default:(0,t.k6)((({open:e})=>[(0,t.bF)(d,{type:"primary",icon:"sc-icon-download",onClick:e},{default:(0,t.k6)((()=>l[16]||(l[16]=[(0,t.eW)("导出(blob文件流)")]))),_:2},1032,["onClick"])])),form:(0,t.k6)((({formData:e})=>[(0,t.bF)(m,{label:"导出条数"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:e.limit,"onUpdate:modelValue":l=>e.limit=l,placeholder:"Select"},{default:(0,t.k6)((()=>[(0,t.bF)(y,{label:"100条",value:"100"}),(0,t.bF)(y,{label:"500条",value:"500"}),(0,t.bF)(y,{label:"1000条",value:"1000"}),(0,t.bF)(y,{label:"5000条",value:"5000"}),(0,t.bF)(y,{label:"10000条",value:"10000"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:1},8,["apiObj","column"]),(0,t.bF)(f,{column:1,border:"",size:"small",style:{"margin-top":"15px"}},{default:(0,t.k6)((()=>[(0,t.bF)(b,{label:"apiObj",width:200},{default:(0,t.k6)((()=>l[17]||(l[17]=[(0,t.eW)("Object 文件导出接口对象，通过apiObj.url请求文件")]))),_:1}),(0,t.bF)(b,{label:"data"},{default:(0,t.k6)((()=>l[18]||(l[18]=[(0,t.eW)("Object 上传时附带的额外参数(可为数据表格的过滤项)")]))),_:1}),(0,t.bF)(b,{label:"showData"},{default:(0,t.k6)((()=>l[19]||(l[19]=[(0,t.eW)("Boolean 是否显示附带的额外参数")]))),_:1}),(0,t.bF)(b,{label:"async"},{default:(0,t.k6)((()=>l[20]||(l[20]=[(0,t.eW)("Boolean 是否异步导出文件")]))),_:1}),(0,t.bF)(b,{label:"fileName"},{default:(0,t.k6)((()=>l[21]||(l[21]=[(0,t.eW)("String 下载文件名称，默认为当前时间戳")]))),_:1}),(0,t.bF)(b,{label:"fileTypes"},{default:(0,t.k6)((()=>l[22]||(l[22]=[(0,t.eW)("Array 可选择文件类型，默认为['xlsx']，组件将数组第一项当做已选项")]))),_:1}),(0,t.bF)(b,{label:"column"},{default:(0,t.k6)((()=>l[23]||(l[23]=[(0,t.eW)('Array 列配置，请求文件时将添加column为key的参数，值为prop逗号","分割的字符串')]))),_:1}),(0,t.bF)(b,{label:"blob"},{default:(0,t.k6)((()=>l[24]||(l[24]=[(0,t.eW)("Boolean 是否由游览器请求文件返回blob后提供下载")]))),_:1}),(0,t.bF)(b,{label:"progress"},{default:(0,t.k6)((()=>l[25]||(l[25]=[(0,t.eW)("Boolean blob开启后是否显示下载文件进度条，当服务器启用Gzip时，建议关闭，因为获取到的文件总数和下载总数不匹配。")]))),_:1}),(0,t.bF)(b,{label:'#default="{open}"'},{default:(0,t.k6)((()=>l[26]||(l[26]=[(0,t.eW)("插糟 默认触发按钮插糟，返回open()打开窗口函数，可以绑定元素@click事件")]))),_:1}),(0,t.bF)(b,{label:'#form="{formData}"'},{default:(0,t.k6)((()=>l[27]||(l[27]=[(0,t.eW)("插糟 自定义表单组件，插槽formData都将作为请求时附带的额外参数")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.bF)(V,{modelValue:r.importErrDialogVisible,"onUpdate:modelValue":l[1]||(l[1]=e=>r.importErrDialogVisible=e),title:"导入失败",width:680,"destroy-on-close":"",onClosed:l[2]||(l[2]=()=>{r.importErrData={}})},{footer:(0,t.k6)((()=>[(0,t.bF)(d,{type:"primary",onClick:l[0]||(l[0]=e=>r.importErrDialogVisible=!1)},{default:(0,t.k6)((()=>l[29]||(l[29]=[(0,t.eW)("我知道了")]))),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(x,{title:`总条目数 ${r.importErrData.ok} ,其中有 ${r.importErrData.fail} 条格式不满足导入要求，请修改后再次操作。`,type:"error","show-icon":"",closable:!1},null,8,["title"]),(0,t.Lk)("div",o,[(0,t.bF)(C,{data:r.importErrData.failList,border:"",stripe:"","max-height":"270",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(D,{prop:"keyName",label:"主键名",width:"180"}),(0,t.bF)(D,{prop:"",label:"状态",width:"100"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{type:"danger"},{default:(0,t.k6)((()=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.bF)(v)])),_:1}),l[28]||(l[28]=(0,t.eW)(" 失败"))])),_:1})])),_:1}),(0,t.bF)(D,{prop:"reason",label:"原因"})])),_:1},8,["data"])])])),_:1},8,["modelValue"])],64)}var r=a(33);const s={class:"el-upload__tip"},n={key:2,style:{"margin-top":"7px"}};function d(e,l,a,o,i,d){const p=(0,t.g2)("el-button"),u=(0,t.g2)("el-progress"),c=(0,t.g2)("el-icon-upload-filled"),m=(0,t.g2)("el-icon"),b=(0,t.g2)("el-link"),f=(0,t.g2)("el-upload"),g=(0,t.g2)("el-form"),h=(0,t.g2)("el-dialog"),k=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.RG)(e.$slots,"default",{open:d.open},(()=>[(0,t.bF)(p,{type:"primary",plain:"",onClick:d.open},{default:(0,t.k6)((()=>l[1]||(l[1]=[(0,t.eW)("导入")]))),_:1},8,["onClick"])])),(0,t.bF)(h,{modelValue:i.dialog,"onUpdate:modelValue":l[0]||(l[0]=e=>i.dialog=e),title:"导入",width:550,"close-on-click-modal":!1,"append-to-body":"","destroy-on-close":""},{default:(0,t.k6)((()=>[i.loading?((0,t.uX)(),(0,t.Wv)(u,{key:0,"text-inside":!0,"stroke-width":20,percentage:i.percentage,style:{"margin-bottom":"15px"}},null,8,["percentage"])):(0,t.Q3)("",!0),(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",null,[(0,t.bF)(f,{ref:"uploader",drag:"",accept:a.accept,maxSize:a.maxSize,limit:1,data:a.data,"show-file-list":!1,"http-request":d.request,"before-upload":d.before,"on-progress":d.progress,"on-success":d.success,"on-error":d.error},{tip:(0,t.k6)((()=>[(0,t.Lk)("div",s,[a.tip?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.eW)((0,r.v_)(a.tip),1)],64)):((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.eW)("请上传小于或等于 "+(0,r.v_)(a.maxSize)+"M 的 "+(0,r.v_)(a.accept)+" 格式文件",1)],64)),a.templateUrl?((0,t.uX)(),(0,t.CE)("p",n,[(0,t.bF)(b,{href:a.templateUrl,target:"_blank",type:"primary",underline:!1},{default:(0,t.k6)((()=>l[3]||(l[3]=[(0,t.eW)("下载导入模板")]))),_:1},8,["href"])])):(0,t.Q3)("",!0)])])),default:(0,t.k6)((()=>[(0,t.RG)(e.$slots,"uploader",{},(()=>[(0,t.bF)(m,{class:"el-icon--upload"},{default:(0,t.k6)((()=>[(0,t.bF)(c)])),_:1}),l[2]||(l[2]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将文件拖到此处或 "),(0,t.Lk)("em",null,"点击选择文件上传")],-1))]))])),_:3},8,["accept","maxSize","data","http-request","before-upload","on-progress","on-success","on-error"]),e.$slots.form?((0,t.uX)(),(0,t.Wv)(g,{key:0,inline:"","label-width":"100px","label-position":"left",style:{"margin-top":"18px"}},{default:(0,t.k6)((()=>[(0,t.RG)(e.$slots,"form",{formData:i.formData})])),_:3})):(0,t.Q3)("",!0)])),[[k,i.loading]])])),_:3},8,["modelValue"])],64)}var p={emits:["success"],props:{apiObj:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},accept:{type:String,default:".xls, .xlsx"},maxSize:{type:Number,default:10},tip:{type:String,default:""},templateUrl:{type:String,default:""}},data(){return{dialog:!1,loading:!1,percentage:0,formData:{}}},mounted(){},methods:{open(){this.dialog=!0,this.formData={}},close(){this.dialog=!1},before(e){const l=e.size/1024/1024<this.maxSize;if(!l)return this.$message.warning(`上传文件大小不能超过 ${this.maxSize}MB!`),!1;this.loading=!0},progress(e){this.percentage=e.percent},success(e,l){this.$refs.uploader.handleRemove(l),this.$refs.uploader.clearFiles(),this.loading=!1,this.percentage=0,this.$emit("success",e,this.close)},error(e){this.loading=!1,this.percentage=0,this.$notify.error({title:"上传文件未成功",message:e})},request(e){Object.assign(e.data,this.formData);const l=new FormData;l.append(e.filename,e.file);for(const a in e.data)l.append(a,e.data[a]);this.apiObj.post(l,{onUploadProgress:l=>{const a=parseInt(l.loaded/l.total*100|0,10);e.onProgress({percent:a})}}).then((l=>{e.onSuccess(l)})).catch((l=>{e.onError(l)}))}}},u=a(6262);const c=(0,u.A)(p,[["render",d]]);var m=c;const b={"element-loading-text":"正在处理中..."},f={key:0,style:{position:"absolute",width:"100%",height:"100%",display:"flex","justify-content":"center","align-items":"center","z-index":"3000"}};function g(e,l,a,o,i,s){const n=(0,t.g2)("el-button"),d=(0,t.g2)("el-progress"),p=(0,t.g2)("el-input"),u=(0,t.g2)("el-form-item"),c=(0,t.g2)("el-option"),m=(0,t.g2)("el-select"),g=(0,t.g2)("el-form"),h=(0,t.g2)("el-tab-pane"),k=(0,t.g2)("columnSet"),y=(0,t.g2)("el-descriptions-item"),F=(0,t.g2)("el-descriptions"),_=(0,t.g2)("el-tabs"),w=(0,t.g2)("el-main"),x=(0,t.g2)("el-drawer"),D=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.RG)(e.$slots,"default",{open:s.open},(()=>[(0,t.bF)(n,{type:"primary",plain:"",onClick:s.open},{default:(0,t.k6)((()=>l[3]||(l[3]=[(0,t.eW)("导出")]))),_:1},8,["onClick"])])),(0,t.bF)(x,{modelValue:i.dialog,"onUpdate:modelValue":l[2]||(l[2]=e=>i.dialog=e),title:"导出",size:400,direction:"rtl","append-to-body":"","destroy-on-close":""},{default:(0,t.k6)((()=>[(0,t.bF)(w,{style:{padding:"0 20px 20px 20px"}},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",b,[i.downLoading&&a.progress?((0,t.uX)(),(0,t.CE)("div",f,[(0,t.bF)(d,{"text-inside":!0,"stroke-width":20,percentage:i.downLoadProgress,style:{width:"100%","margin-bottom":"120px"}},null,8,["percentage"])])):(0,t.Q3)("",!0),(0,t.bF)(_,null,{default:(0,t.k6)((()=>[(0,t.bF)(h,{label:"常规",lazy:""},{default:(0,t.k6)((()=>[(0,t.bF)(g,{"label-width":"100px","label-position":"left",style:{margin:"10px 0 20px 0"}},{default:(0,t.k6)((()=>[(0,t.bF)(u,{label:"文件名"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:i.formData.fileName,"onUpdate:modelValue":l[0]||(l[0]=e=>i.formData.fileName=e),placeholder:"请输入文件名"},null,8,["modelValue"])])),_:1}),(0,t.bF)(u,{label:"文件类型"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:i.formData.fileType,"onUpdate:modelValue":l[1]||(l[1]=e=>i.formData.fileType=e),placeholder:"请选择文件类型"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.fileTypes,(e=>((0,t.uX)(),(0,t.Wv)(c,{key:e,label:"*."+e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.RG)(e.$slots,"form",{formData:i.formData})])),_:3}),a.async?((0,t.uX)(),(0,t.Wv)(n,{key:0,type:"primary",size:"large",icon:"el-icon-plus",style:{width:"100%"},onClick:s.download,loading:i.asyncLoading},{default:(0,t.k6)((()=>l[4]||(l[4]=[(0,t.eW)("发起导出任务")]))),_:1},8,["onClick","loading"])):((0,t.uX)(),(0,t.Wv)(n,{key:1,type:"primary",size:"large",icon:"el-icon-download",style:{width:"100%"},onClick:s.download},{default:(0,t.k6)((()=>l[5]||(l[5]=[(0,t.eW)("下 载")]))),_:1},8,["onClick"]))])),_:3}),i.columnData.length>0?((0,t.uX)(),(0,t.Wv)(h,{key:0,label:"列设置",lazy:""},{default:(0,t.k6)((()=>[(0,t.bF)(k,{column:i.columnData},null,8,["column"])])),_:1})):(0,t.Q3)("",!0),a.data&&a.showData?((0,t.uX)(),(0,t.Wv)(h,{key:1,label:"其他参数",lazy:""},{default:(0,t.k6)((()=>[(0,t.bF)(F,{column:1,border:"",size:"small"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.data,((e,l)=>((0,t.uX)(),(0,t.Wv)(y,{key:l,label:l},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(e),1)])),_:2},1032,["label"])))),128))])),_:1})])),_:1})):(0,t.Q3)("",!0)])),_:3})])),[[D,i.downLoading]])])),_:3})])),_:3},8,["modelValue"])],64)}a(8743),a(2838);function h(e,l,a,o,i,s){const n=(0,t.g2)("el-icon-d-caret"),d=(0,t.g2)("el-icon"),p=(0,t.g2)("el-tag"),u=(0,t.g2)("el-table-column"),c=(0,t.g2)("el-switch"),m=(0,t.g2)("el-table");return(0,t.uX)(),(0,t.Wv)(m,{ref:"table",data:i.columnData,"row-key":"prop",style:{width:"100%"},border:""},{default:(0,t.k6)((()=>[(0,t.bF)(u,{prop:"",label:"排序",width:"60"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{"disable-transitions":"",class:"move",style:{cursor:"move"}},{default:(0,t.k6)((()=>[(0,t.bF)(d,{style:{cursor:"move"}},{default:(0,t.k6)((()=>[(0,t.bF)(n)])),_:1})])),_:1})])),_:1}),(0,t.bF)(u,{prop:"label",label:"列名"},{default:(0,t.k6)((e=>[(0,t.bF)(p,{round:"","disable-transitions":"",effect:e.row.hide?"light":"dark",type:e.row.hide?"info":""},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(e.row.label),1)])),_:2},1032,["effect","type"])])),_:1}),(0,t.bF)(u,{prop:"hide",label:"显示",width:"60"},{default:(0,t.k6)((e=>[(0,t.bF)(c,{modelValue:e.row.hide,"onUpdate:modelValue":l=>e.row.hide=l,size:"small","active-value":!1,"inactive-value":!0},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"])}var k=a(246),y={emits:["success"],props:{column:{type:Array,default:()=>[]}},data(){return{columnData:this.column}},mounted(){this.rowDrop()},methods:{rowDrop(){const e=this,l=this.$refs.table.$el.querySelector(".el-table__body-wrapper tbody");k.Ay.create(l,{handle:".move",animation:200,ghostClass:"ghost",onEnd({newIndex:l,oldIndex:a}){const t=e.columnData,o=t.splice(a,1)[0];t.splice(l,0,o)}})}}};const F=(0,u.A)(y,[["render",h]]);var _=F,w={components:{columnSet:_},props:{apiObj:{type:Object,default:()=>{}},fileName:{type:String,default:""},fileTypes:{type:Array,default:()=>["xlsx"]},data:{type:Object,default:()=>{}},showData:{type:Boolean,default:!1},async:{type:Boolean,default:!1},column:{type:Array,default:()=>[]},blob:{type:Boolean,default:!1},progress:{type:Boolean,default:!0}},data(){return{dialog:!1,formData:{fileName:this.fileName,fileType:this.fileTypes[0]},columnData:[],downLoading:!1,downLoadProgress:0,asyncLoading:!1}},watch:{"formData.fileType"(e){this.formData.fileName.includes(".")?this.formData.fileName=this.formData.fileName.substring(0,this.formData.fileName.lastIndexOf("."))+"."+e:this.formData.fileName=this.formData.fileName+"."+e}},mounted(){},methods:{open(){this.dialog=!0,this.formData={fileName:(this.fileName?this.fileName:(new Date).getTime()+"")+"."+this.fileTypes[0],fileType:this.fileTypes[0]},this.columnData=JSON.parse(JSON.stringify(this.column))},close(){this.dialog=!1},download(){let e={column:this.columnData.filter((e=>!e.hide)).map((e=>e.prop)).join(",")},l={...this.data,...this.formData,...e};this.async?this.asyncDownload(this.apiObj,this.formData.fileName,l):this.blob?this.downloadFile(this.apiObj,this.formData.fileName,l):this.linkFile(this.apiObj.url,this.formData.fileName,l)},linkFile(e,l,a={}){let t=document.createElement("a");t.style="display: none",t.target="_blank",t.href=e+this.toQueryString(a),document.body.appendChild(t),t.click(),document.body.removeChild(t)},downloadFile(e,l,a={}){this.downLoading=!0;var t=this;e.get(a,{responseType:"blob",onDownloadProgress(e){e.lengthComputable&&(t.downLoadProgress=parseInt(e.loaded/e.total*100))}}).then((e=>{this.downLoading=!1,this.downLoadProgress=0;let a=URL.createObjectURL(e),t=document.createElement("a");t.style="display: none",t.target="_blank",t.download=l,t.href=a,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)})).catch((e=>{this.downLoading=!1,this.downLoadProgress=0,this.$notify.error({title:"下载文件失败",message:e})}))},asyncDownload(e,l,a={}){this.asyncLoading=!0,e.get(a).then((e=>{this.asyncLoading=!1,200==e.code?(this.dialog=!1,this.$msgbox({title:"成功发起任务",message:'<div><img style="height:200px" src="img/tasks-example.png"/></div><p>已成功发起导出任务，您可以操作其他事务</p><p>稍后可在 <b>任务中心</b> 查看执行结果</p>',type:"success",confirmButtonText:"知道了",dangerouslyUseHTMLString:!0,center:!0}).catch((()=>{}))):this.$alert(e.message||"未知错误","发起任务失败",{type:"error",center:!0}).catch((()=>{}))})).catch((()=>{this.asyncLoading=!1}))},toQueryString(e){let l=[];for(var a in e)l.push(`${a}=${e[a]}`);return(l.length>0?"?":"")+l.join("&")}}};const x=(0,u.A)(w,[["render",g]]);var D=x,v={name:"importexport",components:{scFileImport:m,scFileExport:D},data(){return{importErrDialogVisible:!1,importErrData:{},column:[{label:"姓名",prop:"name"},{label:"性别",prop:"sex"},{label:"评分",prop:"num"},{label:"邮箱",prop:"email",hide:!0},{label:"进度",prop:"progress"},{label:"注册时间",prop:"datetime"}]}},mounted(){},methods:{success(e,l){200==e.code?(this.$alert("导入返回成功后，可后续操作，比如刷新表格等。执行回调函数close()可关闭上传窗口。","导入成功",{type:"success",showClose:!1,center:!0}),l()):(this.importErrDialogVisible=!0,this.importErrData=e.data)}}};const W=(0,u.A)(v,[["render",i]]);var C=W}}]);