"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[4708],{8483:function(e,l,o){o.r(l),o.d(l,{default:function(){return dl}});var t=o(641);const d={class:"do"};function i(e,l,o,i,a,n){const s=(0,t.g2)("el-page-header"),r=(0,t.g2)("el-button"),u=(0,t.g2)("el-header"),c=(0,t.g2)("sc-workflow"),p=(0,t.g2)("el-main"),m=(0,t.g2)("el-container");return(0,t.uX)(),(0,t.Wv)(m,null,{default:(0,t.k6)((()=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.bF)(s,{content:a.data.name},null,8,["content"]),(0,t.Lk)("div",d,[(0,t.bF)(r,{type:"primary",onClick:n.exportJson},{default:(0,t.k6)((()=>l[1]||(l[1]=[(0,t.eW)("export JSON")]))),_:1},8,["onClick"])])])),_:1}),(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.bF)(c,{modelValue:a.data.nodeConfig,"onUpdate:modelValue":l[0]||(l[0]=e=>a.data.nodeConfig=e)},null,8,["modelValue"])])),_:1})])),_:1})}const a={class:"sc-workflow-design"},n={class:"box-scale"};function s(e,l,o,d,i,s){const r=(0,t.g2)("node-wrap"),u=(0,t.g2)("use-select");return(0,t.uX)(),(0,t.CE)("div",a,[(0,t.Lk)("div",n,[i.nodeConfig?((0,t.uX)(),(0,t.Wv)(r,{key:0,modelValue:i.nodeConfig,"onUpdate:modelValue":l[0]||(l[0]=e=>i.nodeConfig=e)},null,8,["modelValue"])):(0,t.Q3)("",!0),l[2]||(l[2]=(0,t.Lk)("div",{class:"end-node"},[(0,t.Lk)("div",{class:"end-node-circle"}),(0,t.Lk)("div",{class:"end-node-text"},"流程结束")],-1))]),i.selectVisible?((0,t.uX)(),(0,t.Wv)(u,{key:0,ref:"useselect",onClosed:l[1]||(l[1]=e=>i.selectVisible=!1)},null,512)):(0,t.Q3)("",!0)])}function r(e,l,o,d,i,a){const n=(0,t.g2)("promoter"),s=(0,t.g2)("approver"),r=(0,t.g2)("send"),u=(0,t.g2)("node-wrap",!0),c=(0,t.g2)("branch");return(0,t.uX)(),(0,t.CE)(t.FK,null,[0==i.nodeConfig.type?((0,t.uX)(),(0,t.Wv)(n,{key:0,modelValue:i.nodeConfig,"onUpdate:modelValue":l[0]||(l[0]=e=>i.nodeConfig=e)},null,8,["modelValue"])):(0,t.Q3)("",!0),1==i.nodeConfig.type?((0,t.uX)(),(0,t.Wv)(s,{key:1,modelValue:i.nodeConfig,"onUpdate:modelValue":l[1]||(l[1]=e=>i.nodeConfig=e)},null,8,["modelValue"])):(0,t.Q3)("",!0),2==i.nodeConfig.type?((0,t.uX)(),(0,t.Wv)(r,{key:2,modelValue:i.nodeConfig,"onUpdate:modelValue":l[2]||(l[2]=e=>i.nodeConfig=e)},null,8,["modelValue"])):(0,t.Q3)("",!0),4==i.nodeConfig.type?((0,t.uX)(),(0,t.Wv)(c,{key:3,modelValue:i.nodeConfig,"onUpdate:modelValue":l[3]||(l[3]=e=>i.nodeConfig=e)},{default:(0,t.k6)((e=>[e.node?((0,t.uX)(),(0,t.Wv)(u,{key:0,modelValue:e.node.childNode,"onUpdate:modelValue":l=>e.node.childNode=l},null,8,["modelValue","onUpdate:modelValue"])):(0,t.Q3)("",!0)])),_:1},8,["modelValue"])):(0,t.Q3)("",!0),i.nodeConfig.childNode?((0,t.uX)(),(0,t.Wv)(u,{key:4,modelValue:i.nodeConfig.childNode,"onUpdate:modelValue":l[4]||(l[4]=e=>i.nodeConfig.childNode=e)},null,8,["modelValue"])):(0,t.Q3)("",!0)],64)}var u=o(33),c=o(3751);const p={class:"node-wrap"},m={class:"title",style:{background:"#ff943e"}},f={class:"content"},k={key:0},g={key:1,class:"placeholder"},h={class:"node-wrap-drawer__title"},b={class:"tags-list"},C={class:"tags-list"},y={key:0},v={style:{width:"100%"}},_={style:{width:"100%"}},F={style:{width:"100%"}};function V(e,l,o,d,i,a){const n=(0,t.g2)("el-icon-user-filled"),s=(0,t.g2)("el-icon"),r=(0,t.g2)("el-icon-close"),V=(0,t.g2)("add-node"),L=(0,t.g2)("el-icon-edit"),w=(0,t.g2)("el-input"),N=(0,t.g2)("el-option"),T=(0,t.g2)("el-select"),U=(0,t.g2)("el-form-item"),W=(0,t.g2)("el-button"),x=(0,t.g2)("el-tag"),X=(0,t.g2)("el-input-number"),E=(0,t.g2)("el-radio"),$=(0,t.g2)("el-radio-group"),Q=(0,t.g2)("el-divider"),S=(0,t.g2)("el-checkbox"),M=(0,t.g2)("el-form"),R=(0,t.g2)("el-main"),j=(0,t.g2)("el-footer"),O=(0,t.g2)("el-container"),I=(0,t.g2)("el-drawer");return(0,t.uX)(),(0,t.CE)("div",p,[(0,t.Lk)("div",{class:"node-wrap-box",onClick:l[1]||(l[1]=(...e)=>a.show&&a.show(...e))},[(0,t.Lk)("div",m,[(0,t.bF)(s,{class:"icon"},{default:(0,t.k6)((()=>[(0,t.bF)(n)])),_:1}),(0,t.Lk)("span",null,(0,u.v_)(i.nodeConfig.nodeName),1),(0,t.bF)(s,{class:"close",onClick:l[0]||(l[0]=(0,c.D$)((e=>a.delNode()),["stop"]))},{default:(0,t.k6)((()=>[(0,t.bF)(r)])),_:1})]),(0,t.Lk)("div",f,[a.toText(i.nodeConfig)?((0,t.uX)(),(0,t.CE)("span",k,(0,u.v_)(a.toText(i.nodeConfig)),1)):((0,t.uX)(),(0,t.CE)("span",g,"请选择"))])]),(0,t.bF)(V,{modelValue:i.nodeConfig.childNode,"onUpdate:modelValue":l[2]||(l[2]=e=>i.nodeConfig.childNode=e)},null,8,["modelValue"]),(0,t.bF)(I,{title:"审批人设置",modelValue:i.drawer,"onUpdate:modelValue":l[17]||(l[17]=e=>i.drawer=e),"destroy-on-close":"","append-to-body":"",size:500},{header:(0,t.k6)((()=>[(0,t.Lk)("div",h,[i.isEditTitle?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("label",{key:0,onClick:l[3]||(l[3]=(...e)=>a.editTitle&&a.editTitle(...e))},[(0,t.eW)((0,u.v_)(i.form.nodeName),1),(0,t.bF)(s,{class:"node-wrap-drawer__title-edit"},{default:(0,t.k6)((()=>[(0,t.bF)(L)])),_:1})])),i.isEditTitle?((0,t.uX)(),(0,t.Wv)(w,{key:1,ref:"nodeTitle",modelValue:i.form.nodeName,"onUpdate:modelValue":l[4]||(l[4]=e=>i.form.nodeName=e),clearable:"",onBlur:a.saveTitle,onKeyup:(0,c.jR)(a.saveTitle,["enter"])},null,8,["modelValue","onBlur","onKeyup"])):(0,t.Q3)("",!0)])])),default:(0,t.k6)((()=>[(0,t.bF)(O,null,{default:(0,t.k6)((()=>[(0,t.bF)(R,{style:{padding:"0 20px 20px 20px"}},{default:(0,t.k6)((()=>[(0,t.bF)(M,{"label-position":"top"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{label:"审批人员类型"},{default:(0,t.k6)((()=>[(0,t.bF)(T,{modelValue:i.form.setType,"onUpdate:modelValue":l[5]||(l[5]=e=>i.form.setType=e)},{default:(0,t.k6)((()=>[(0,t.bF)(N,{value:1,label:"指定成员"}),(0,t.bF)(N,{value:2,label:"主管"}),(0,t.bF)(N,{value:3,label:"角色"}),(0,t.bF)(N,{value:4,label:"发起人自选"}),(0,t.bF)(N,{value:5,label:"发起人自己"}),(0,t.bF)(N,{value:7,label:"连续多级主管"})])),_:1},8,["modelValue"])])),_:1}),1==i.form.setType?((0,t.uX)(),(0,t.Wv)(U,{key:0,label:"选择成员"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{type:"primary",icon:"el-icon-plus",round:"",onClick:l[6]||(l[6]=e=>a.selectHandle(1,i.form.nodeUserList))},{default:(0,t.k6)((()=>l[18]||(l[18]=[(0,t.eW)("选择人员")]))),_:1}),(0,t.Lk)("div",b,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.form.nodeUserList,((e,l)=>((0,t.uX)(),(0,t.Wv)(x,{key:e.id,closable:"",onClose:e=>a.delUser(l)},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.name),1)])),_:2},1032,["onClose"])))),128))])])),_:1})):(0,t.Q3)("",!0),2==i.form.setType?((0,t.uX)(),(0,t.Wv)(U,{key:1,label:"指定主管"},{default:(0,t.k6)((()=>[l[19]||(l[19]=(0,t.eW)(" 发起人的第 ")),(0,t.bF)(X,{modelValue:i.form.examineLevel,"onUpdate:modelValue":l[7]||(l[7]=e=>i.form.examineLevel=e),min:1},null,8,["modelValue"]),l[20]||(l[20]=(0,t.eW)(" 级主管 "))])),_:1})):(0,t.Q3)("",!0),3==i.form.setType?((0,t.uX)(),(0,t.Wv)(U,{key:2,label:"选择角色"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{type:"primary",icon:"el-icon-plus",round:"",onClick:l[8]||(l[8]=e=>a.selectHandle(2,i.form.nodeRoleList))},{default:(0,t.k6)((()=>l[21]||(l[21]=[(0,t.eW)("选择角色")]))),_:1}),(0,t.Lk)("div",C,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.form.nodeRoleList,((e,l)=>((0,t.uX)(),(0,t.Wv)(x,{key:e.id,type:"info",closable:"",onClose:e=>a.delRole(l)},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.name),1)])),_:2},1032,["onClose"])))),128))])])),_:1})):(0,t.Q3)("",!0),4==i.form.setType?((0,t.uX)(),(0,t.Wv)(U,{key:3,label:"发起人自选"},{default:(0,t.k6)((()=>[(0,t.bF)($,{modelValue:i.form.selectMode,"onUpdate:modelValue":l[9]||(l[9]=e=>i.form.selectMode=e)},{default:(0,t.k6)((()=>[(0,t.bF)(E,{label:1},{default:(0,t.k6)((()=>l[22]||(l[22]=[(0,t.eW)("自选一个人")]))),_:1}),(0,t.bF)(E,{label:2},{default:(0,t.k6)((()=>l[23]||(l[23]=[(0,t.eW)("自选多个人")]))),_:1})])),_:1},8,["modelValue"])])),_:1})):(0,t.Q3)("",!0),7==i.form.setType?((0,t.uX)(),(0,t.Wv)(U,{key:4,label:"连续主管审批终点"},{default:(0,t.k6)((()=>[(0,t.bF)($,{modelValue:i.form.directorMode,"onUpdate:modelValue":l[10]||(l[10]=e=>i.form.directorMode=e)},{default:(0,t.k6)((()=>[(0,t.bF)(E,{label:0},{default:(0,t.k6)((()=>l[24]||(l[24]=[(0,t.eW)("直到最上层主管")]))),_:1}),(0,t.bF)(E,{label:1},{default:(0,t.k6)((()=>l[25]||(l[25]=[(0,t.eW)("自定义审批终点")]))),_:1})])),_:1},8,["modelValue"]),1==i.form.directorMode?((0,t.uX)(),(0,t.CE)("p",y,[l[26]||(l[26]=(0,t.eW)("直到发起人的第 ")),(0,t.bF)(X,{modelValue:i.form.directorLevel,"onUpdate:modelValue":l[11]||(l[11]=e=>i.form.directorLevel=e),min:1},null,8,["modelValue"]),l[27]||(l[27]=(0,t.eW)(" 级主管"))])):(0,t.Q3)("",!0)])),_:1})):(0,t.Q3)("",!0),(0,t.bF)(Q),(0,t.bF)(U,{label:""},{default:(0,t.k6)((()=>[(0,t.bF)(S,{modelValue:i.form.termAuto,"onUpdate:modelValue":l[12]||(l[12]=e=>i.form.termAuto=e),label:"超时自动审批"},null,8,["modelValue"])])),_:1}),i.form.termAuto?((0,t.uX)(),(0,t.CE)(t.FK,{key:5},[(0,t.bF)(U,{label:"审批期限（为 0 则不生效）"},{default:(0,t.k6)((()=>[(0,t.bF)(X,{modelValue:i.form.term,"onUpdate:modelValue":l[13]||(l[13]=e=>i.form.term=e),min:0},null,8,["modelValue"]),l[28]||(l[28]=(0,t.eW)(" 小时 "))])),_:1}),(0,t.bF)(U,{label:"审批期限超时后执行"},{default:(0,t.k6)((()=>[(0,t.bF)($,{modelValue:i.form.termMode,"onUpdate:modelValue":l[14]||(l[14]=e=>i.form.termMode=e)},{default:(0,t.k6)((()=>[(0,t.bF)(E,{label:0},{default:(0,t.k6)((()=>l[29]||(l[29]=[(0,t.eW)("自动通过")]))),_:1}),(0,t.bF)(E,{label:1},{default:(0,t.k6)((()=>l[30]||(l[30]=[(0,t.eW)("自动拒绝")]))),_:1})])),_:1},8,["modelValue"])])),_:1})],64)):(0,t.Q3)("",!0),(0,t.bF)(Q),(0,t.bF)(U,{label:"多人审批时审批方式"},{default:(0,t.k6)((()=>[(0,t.bF)($,{modelValue:i.form.examineMode,"onUpdate:modelValue":l[15]||(l[15]=e=>i.form.examineMode=e)},{default:(0,t.k6)((()=>[(0,t.Lk)("p",v,[(0,t.bF)(E,{label:1},{default:(0,t.k6)((()=>l[31]||(l[31]=[(0,t.eW)("按顺序依次审批")]))),_:1})]),(0,t.Lk)("p",_,[(0,t.bF)(E,{label:2},{default:(0,t.k6)((()=>l[32]||(l[32]=[(0,t.eW)("会签 (可同时审批，每个人必须审批通过)")]))),_:1})]),(0,t.Lk)("p",F,[(0,t.bF)(E,{label:3},{default:(0,t.k6)((()=>l[33]||(l[33]=[(0,t.eW)("或签 (有一人审批通过即可)")]))),_:1})])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(j,null,{default:(0,t.k6)((()=>[(0,t.bF)(W,{type:"primary",onClick:a.save},{default:(0,t.k6)((()=>l[34]||(l[34]=[(0,t.eW)("保存")]))),_:1},8,["onClick"]),(0,t.bF)(W,{onClick:l[16]||(l[16]=e=>i.drawer=!1)},{default:(0,t.k6)((()=>l[35]||(l[35]=[(0,t.eW)("取消")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}const L={class:"add-node-btn-box"},w={class:"add-node-btn"},N={class:"add-node-popover-body"};function T(e,l,o,d,i,a){const n=(0,t.g2)("el-button"),s=(0,t.g2)("el-icon-user-filled"),r=(0,t.g2)("el-icon"),u=(0,t.g2)("el-icon-promotion"),c=(0,t.g2)("el-icon-share"),p=(0,t.g2)("el-popover");return(0,t.uX)(),(0,t.CE)("div",L,[(0,t.Lk)("div",w,[(0,t.bF)(p,{placement:"right-start",width:270,trigger:"click","hide-after":0,"show-after":0},{reference:(0,t.k6)((()=>[(0,t.bF)(n,{type:"primary",icon:"el-icon-plus",circle:""})])),default:(0,t.k6)((()=>[(0,t.Lk)("div",N,[(0,t.Lk)("ul",null,[(0,t.Lk)("li",null,[(0,t.bF)(r,{style:{color:"#ff943e"},onClick:l[0]||(l[0]=e=>a.addType(1))},{default:(0,t.k6)((()=>[(0,t.bF)(s)])),_:1}),l[3]||(l[3]=(0,t.Lk)("p",null,"审批节点",-1))]),(0,t.Lk)("li",null,[(0,t.bF)(r,{style:{color:"#3296fa"},onClick:l[1]||(l[1]=e=>a.addType(2))},{default:(0,t.k6)((()=>[(0,t.bF)(u)])),_:1}),l[4]||(l[4]=(0,t.Lk)("p",null,"抄送节点",-1))]),(0,t.Lk)("li",null,[(0,t.bF)(r,{style:{color:"#15BC83"},onClick:l[2]||(l[2]=e=>a.addType(4))},{default:(0,t.k6)((()=>[(0,t.bF)(c)])),_:1}),l[5]||(l[5]=(0,t.Lk)("p",null,"条件分支",-1))])])])])),_:1})])])}var U={props:{modelValue:{type:Object,default:()=>{}}},data(){return{}},mounted(){},methods:{addType(e){var l={};1==e?l={nodeName:"审核人",type:1,setType:1,nodeUserList:[],nodeRoleList:[],examineLevel:1,directorLevel:1,selectMode:1,termAuto:!1,term:0,termMode:1,examineMode:1,directorMode:0,childNode:this.modelValue}:2==e?l={nodeName:"抄送人",type:2,userSelectFlag:!0,nodeUserList:[],childNode:this.modelValue}:4==e&&(l={nodeName:"条件路由",type:4,conditionNodes:[{nodeName:"条件1",type:3,priorityLevel:1,conditionMode:1,conditionList:[]},{nodeName:"条件2",type:3,priorityLevel:2,conditionMode:1,conditionList:[]}],childNode:this.modelValue}),this.$emit("update:modelValue",l)}}},W=o(6262);const x=(0,W.A)(U,[["render",T]]);var X=x,E={inject:["select"],props:{modelValue:{type:Object,default:()=>{}}},components:{addNode:X},data(){return{nodeConfig:{},drawer:!1,isEditTitle:!1,form:{}}},watch:{modelValue(){this.nodeConfig=this.modelValue}},mounted(){this.nodeConfig=this.modelValue},methods:{show(){this.form={},this.form=JSON.parse(JSON.stringify(this.nodeConfig)),this.drawer=!0},editTitle(){this.isEditTitle=!0,this.$nextTick((()=>{this.$refs.nodeTitle.focus()}))},saveTitle(){this.isEditTitle=!1},save(){this.$emit("update:modelValue",this.form),this.drawer=!1},delNode(){this.$emit("update:modelValue",this.nodeConfig.childNode)},delUser(e){this.form.nodeUserList.splice(e,1)},delRole(e){this.form.nodeRoleList.splice(e,1)},selectHandle(e,l){this.select(e,l)},toText(e){if(1==e.setType){if(e.nodeUserList&&e.nodeUserList.length>0){const l=e.nodeUserList.map((e=>e.name)).join("、");return l}return!1}if(2==e.setType)return 1==e.examineLevel?"直接主管":`发起人的第${e.examineLevel}级主管`;if(3==e.setType){if(e.nodeRoleList&&e.nodeRoleList.length>0){const l=e.nodeRoleList.map((e=>e.name)).join("、");return"角色-"+l}return!1}return 4==e.setType?"发起人自选":5==e.setType?"发起人自己":7==e.setType?"连续多级主管":void 0}}};const $=(0,W.A)(E,[["render",V]]);var Q=$;const S={class:"node-wrap"},M={class:"title",style:{background:"#576a95"}},R={class:"content"},j={class:"node-wrap-drawer__title"},O={class:"tags-list"};function I(e,l,o,d,i,a){const n=(0,t.g2)("el-icon-user-filled"),s=(0,t.g2)("el-icon"),r=(0,t.g2)("add-node"),p=(0,t.g2)("el-icon-edit"),m=(0,t.g2)("el-input"),f=(0,t.g2)("el-button"),k=(0,t.g2)("el-tag"),g=(0,t.g2)("el-form-item"),h=(0,t.g2)("el-alert"),b=(0,t.g2)("el-form"),C=(0,t.g2)("el-main"),y=(0,t.g2)("el-footer"),v=(0,t.g2)("el-container"),_=(0,t.g2)("el-drawer");return(0,t.uX)(),(0,t.CE)("div",S,[(0,t.Lk)("div",{class:"node-wrap-box start-node",onClick:l[0]||(l[0]=(...e)=>a.show&&a.show(...e))},[(0,t.Lk)("div",M,[(0,t.bF)(s,{class:"icon"},{default:(0,t.k6)((()=>[(0,t.bF)(n)])),_:1}),(0,t.Lk)("span",null,(0,u.v_)(i.nodeConfig.nodeName),1)]),(0,t.Lk)("div",R,[(0,t.Lk)("span",null,(0,u.v_)(a.toText(i.nodeConfig)),1)])]),(0,t.bF)(r,{modelValue:i.nodeConfig.childNode,"onUpdate:modelValue":l[1]||(l[1]=e=>i.nodeConfig.childNode=e)},null,8,["modelValue"]),(0,t.bF)(_,{title:"发起人",modelValue:i.drawer,"onUpdate:modelValue":l[6]||(l[6]=e=>i.drawer=e),"destroy-on-close":"","append-to-body":"",size:500},{header:(0,t.k6)((()=>[(0,t.Lk)("div",j,[i.isEditTitle?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("label",{key:0,onClick:l[2]||(l[2]=(...e)=>a.editTitle&&a.editTitle(...e))},[(0,t.eW)((0,u.v_)(i.form.nodeName),1),(0,t.bF)(s,{class:"node-wrap-drawer__title-edit"},{default:(0,t.k6)((()=>[(0,t.bF)(p)])),_:1})])),i.isEditTitle?((0,t.uX)(),(0,t.Wv)(m,{key:1,ref:"nodeTitle",modelValue:i.form.nodeName,"onUpdate:modelValue":l[3]||(l[3]=e=>i.form.nodeName=e),clearable:"",onBlur:a.saveTitle,onKeyup:(0,c.jR)(a.saveTitle,["enter"])},null,8,["modelValue","onBlur","onKeyup"])):(0,t.Q3)("",!0)])])),default:(0,t.k6)((()=>[(0,t.bF)(v,null,{default:(0,t.k6)((()=>[(0,t.bF)(C,{style:{padding:"0 20px 20px 20px"}},{default:(0,t.k6)((()=>[(0,t.bF)(b,{"label-position":"top"},{default:(0,t.k6)((()=>[(0,t.bF)(g,{label:"谁可以发起此审批"},{default:(0,t.k6)((()=>[(0,t.bF)(f,{type:"primary",icon:"el-icon-plus",round:"",onClick:l[4]||(l[4]=e=>a.selectHandle(2,i.form.nodeRoleList))},{default:(0,t.k6)((()=>l[7]||(l[7]=[(0,t.eW)("选择角色")]))),_:1}),(0,t.Lk)("div",O,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.form.nodeRoleList,((e,l)=>((0,t.uX)(),(0,t.Wv)(k,{key:e.id,type:"info",closable:"",onClose:e=>a.delRole(l)},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.name),1)])),_:2},1032,["onClose"])))),128))])])),_:1}),0==i.form.nodeRoleList.length?((0,t.uX)(),(0,t.Wv)(h,{key:0,title:"不指定则默认所有人都可发起此审批",type:"info",closable:!1})):(0,t.Q3)("",!0)])),_:1})])),_:1}),(0,t.bF)(y,null,{default:(0,t.k6)((()=>[(0,t.bF)(f,{type:"primary",onClick:a.save},{default:(0,t.k6)((()=>l[8]||(l[8]=[(0,t.eW)("保存")]))),_:1},8,["onClick"]),(0,t.bF)(f,{onClick:l[5]||(l[5]=e=>i.drawer=!1)},{default:(0,t.k6)((()=>l[9]||(l[9]=[(0,t.eW)("取消")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var K={inject:["select"],props:{modelValue:{type:Object,default:()=>{}}},components:{addNode:X},data(){return{nodeConfig:{},drawer:!1,isEditTitle:!1,form:{}}},watch:{modelValue(){this.nodeConfig=this.modelValue}},mounted(){this.nodeConfig=this.modelValue},methods:{show(){this.form={},this.form=JSON.parse(JSON.stringify(this.nodeConfig)),this.isEditTitle=!1,this.drawer=!0},editTitle(){this.isEditTitle=!0,this.$nextTick((()=>{this.$refs.nodeTitle.focus()}))},saveTitle(){this.isEditTitle=!1},selectHandle(e,l){this.select(e,l)},delRole(e){this.form.nodeRoleList.splice(e,1)},save(){this.$emit("update:modelValue",this.form),this.drawer=!1},toText(e){return e.nodeRoleList&&e.nodeRoleList.length>0?e.nodeRoleList.map((e=>e.name)).join("、"):"所有人"}}};const A=(0,W.A)(K,[["render",I]]);var P=A;const z={class:"branch-wrap"},D={class:"branch-box-wrap"},J={class:"branch-box"},B={class:"condition-node"},G={class:"condition-node-box"},H=["onClick"],q=["onClick"],Y={class:"title"},Z={class:"node-title"},ee={class:"priority-title"},le={class:"content"},oe={key:0},te={key:1,class:"placeholder"},de=["onClick"],ie={key:1,class:"top-left-cover-line"},ae={key:2,class:"bottom-left-cover-line"},ne={key:3,class:"top-right-cover-line"},se={key:4,class:"bottom-right-cover-line"},re={class:"node-wrap-drawer__title"};function ue(e,l,o,d,i,a){const n=(0,t.g2)("el-button"),s=(0,t.g2)("el-icon-arrow-left"),r=(0,t.g2)("el-icon"),p=(0,t.g2)("el-icon-close"),m=(0,t.g2)("el-icon-arrow-right"),f=(0,t.g2)("add-node"),k=(0,t.g2)("el-icon-edit"),g=(0,t.g2)("el-input"),h=(0,t.g2)("el-radio"),b=(0,t.g2)("el-radio-group"),C=(0,t.g2)("el-form-item"),y=(0,t.g2)("el-divider"),v=(0,t.g2)("el-table-column"),_=(0,t.g2)("el-option"),F=(0,t.g2)("el-select"),V=(0,t.g2)("el-link"),L=(0,t.g2)("el-table"),w=(0,t.g2)("el-form"),N=(0,t.g2)("el-main"),T=(0,t.g2)("el-footer"),U=(0,t.g2)("el-container"),W=(0,t.g2)("el-drawer");return(0,t.uX)(),(0,t.CE)("div",z,[(0,t.Lk)("div",D,[(0,t.Lk)("div",J,[(0,t.bF)(n,{class:"add-branch",type:"success",plain:"",round:"",onClick:a.addTerm},{default:(0,t.k6)((()=>l[6]||(l[6]=[(0,t.eW)("添加条件")]))),_:1},8,["onClick"]),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.nodeConfig.conditionNodes,((l,o)=>((0,t.uX)(),(0,t.CE)("div",{class:"col-box",key:o},[(0,t.Lk)("div",B,[(0,t.Lk)("div",G,[(0,t.Lk)("div",{class:"auto-judge",onClick:e=>a.show(o)},[0!=o?((0,t.uX)(),(0,t.CE)("div",{key:0,class:"sort-left",onClick:(0,c.D$)((e=>a.arrTransfer(o,-1)),["stop"])},[(0,t.bF)(r,null,{default:(0,t.k6)((()=>[(0,t.bF)(s)])),_:1})],8,q)):(0,t.Q3)("",!0),(0,t.Lk)("div",Y,[(0,t.Lk)("span",Z,(0,u.v_)(l.nodeName),1),(0,t.Lk)("span",ee,"优先级"+(0,u.v_)(l.priorityLevel),1),(0,t.bF)(r,{class:"close",onClick:(0,c.D$)((e=>a.delTerm(o)),["stop"])},{default:(0,t.k6)((()=>[(0,t.bF)(p)])),_:2},1032,["onClick"])]),(0,t.Lk)("div",le,[a.toText(i.nodeConfig,o)?((0,t.uX)(),(0,t.CE)("span",oe,(0,u.v_)(a.toText(i.nodeConfig,o)),1)):((0,t.uX)(),(0,t.CE)("span",te,"请设置条件"))]),o!=i.nodeConfig.conditionNodes.length-1?((0,t.uX)(),(0,t.CE)("div",{key:1,class:"sort-right",onClick:(0,c.D$)((e=>a.arrTransfer(o)),["stop"])},[(0,t.bF)(r,null,{default:(0,t.k6)((()=>[(0,t.bF)(m)])),_:1})],8,de)):(0,t.Q3)("",!0)],8,H),(0,t.bF)(f,{modelValue:l.childNode,"onUpdate:modelValue":e=>l.childNode=e},null,8,["modelValue","onUpdate:modelValue"])])]),l.childNode?(0,t.RG)(e.$slots,"default",{key:0,node:l}):(0,t.Q3)("",!0),0==o?((0,t.uX)(),(0,t.CE)("div",ie)):(0,t.Q3)("",!0),0==o?((0,t.uX)(),(0,t.CE)("div",ae)):(0,t.Q3)("",!0),o==i.nodeConfig.conditionNodes.length-1?((0,t.uX)(),(0,t.CE)("div",ne)):(0,t.Q3)("",!0),o==i.nodeConfig.conditionNodes.length-1?((0,t.uX)(),(0,t.CE)("div",se)):(0,t.Q3)("",!0)])))),128))]),(0,t.bF)(f,{modelValue:i.nodeConfig.childNode,"onUpdate:modelValue":l[0]||(l[0]=e=>i.nodeConfig.childNode=e)},null,8,["modelValue"])]),(0,t.bF)(W,{title:"条件设置",modelValue:i.drawer,"onUpdate:modelValue":l[5]||(l[5]=e=>i.drawer=e),"destroy-on-close":"","append-to-body":"",size:600},{header:(0,t.k6)((()=>[(0,t.Lk)("div",re,[i.isEditTitle?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("label",{key:0,onClick:l[1]||(l[1]=(...e)=>a.editTitle&&a.editTitle(...e))},[(0,t.eW)((0,u.v_)(i.form.nodeName),1),(0,t.bF)(r,{class:"node-wrap-drawer__title-edit"},{default:(0,t.k6)((()=>[(0,t.bF)(k)])),_:1})])),i.isEditTitle?((0,t.uX)(),(0,t.Wv)(g,{key:1,ref:"nodeTitle",modelValue:i.form.nodeName,"onUpdate:modelValue":l[2]||(l[2]=e=>i.form.nodeName=e),clearable:"",onBlur:a.saveTitle,onKeyup:(0,c.jR)(a.saveTitle,["enter"])},null,8,["modelValue","onBlur","onKeyup"])):(0,t.Q3)("",!0)])])),default:(0,t.k6)((()=>[(0,t.bF)(U,null,{default:(0,t.k6)((()=>[(0,t.bF)(N,{style:{padding:"0 20px 20px 20px"}},{default:(0,t.k6)((()=>[(0,t.bF)(w,{"label-position":"top"},{default:(0,t.k6)((()=>[(0,t.bF)(C,{label:"条件关系"},{default:(0,t.k6)((()=>[(0,t.bF)(b,{modelValue:i.form.conditionMode,"onUpdate:modelValue":l[3]||(l[3]=e=>i.form.conditionMode=e)},{default:(0,t.k6)((()=>[(0,t.bF)(h,{label:1},{default:(0,t.k6)((()=>l[7]||(l[7]=[(0,t.eW)("且")]))),_:1}),(0,t.bF)(h,{label:2},{default:(0,t.k6)((()=>l[8]||(l[8]=[(0,t.eW)("或")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(y),(0,t.bF)(C,null,{default:(0,t.k6)((()=>[(0,t.bF)(L,{data:i.form.conditionList},{default:(0,t.k6)((()=>[(0,t.bF)(v,{prop:"label",label:"描述"},{default:(0,t.k6)((e=>[(0,t.bF)(g,{modelValue:e.row.label,"onUpdate:modelValue":l=>e.row.label=l,placeholder:"描述"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(v,{prop:"field",label:"条件字段",width:"130"},{default:(0,t.k6)((e=>[(0,t.bF)(g,{modelValue:e.row.field,"onUpdate:modelValue":l=>e.row.field=l,placeholder:"条件字段"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(v,{prop:"operator",label:"运算符",width:"130"},{default:(0,t.k6)((e=>[(0,t.bF)(F,{modelValue:e.row.operator,"onUpdate:modelValue":l=>e.row.operator=l,placeholder:"Select"},{default:(0,t.k6)((()=>[(0,t.bF)(_,{label:"等于",value:"="}),(0,t.bF)(_,{label:"不等于",value:"!="}),(0,t.bF)(_,{label:"大于",value:">"}),(0,t.bF)(_,{label:"大于等于",value:">="}),(0,t.bF)(_,{label:"小于",value:"<"}),(0,t.bF)(_,{label:"小于等于",value:"<="}),(0,t.bF)(_,{label:"包含",value:"include"}),(0,t.bF)(_,{label:"不包含",value:"notinclude"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(v,{prop:"value",label:"值",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(g,{modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l,placeholder:"值"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(v,{prop:"value",label:"移除",width:"55"},{default:(0,t.k6)((e=>[(0,t.bF)(V,{type:"danger",underline:!1,onClick:l=>a.deleteConditionList(e.$index)},{default:(0,t.k6)((()=>l[9]||(l[9]=[(0,t.eW)("移除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.Lk)("p",null,[(0,t.bF)(n,{type:"primary",icon:"el-icon-plus",round:"",onClick:a.addConditionList},{default:(0,t.k6)((()=>l[10]||(l[10]=[(0,t.eW)("增加条件")]))),_:1},8,["onClick"])])])),_:1})])),_:1}),(0,t.bF)(T,null,{default:(0,t.k6)((()=>[(0,t.bF)(n,{type:"primary",onClick:a.save},{default:(0,t.k6)((()=>l[11]||(l[11]=[(0,t.eW)("保存")]))),_:1},8,["onClick"]),(0,t.bF)(n,{onClick:l[4]||(l[4]=e=>i.drawer=!1)},{default:(0,t.k6)((()=>l[12]||(l[12]=[(0,t.eW)("取消")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}o(8743);var ce={props:{modelValue:{type:Object,default:()=>{}}},components:{addNode:X},data(){return{nodeConfig:{},drawer:!1,isEditTitle:!1,index:0,form:{}}},watch:{modelValue(){this.nodeConfig=this.modelValue}},mounted(){this.nodeConfig=this.modelValue},methods:{show(e){this.index=e,this.form={},this.form=JSON.parse(JSON.stringify(this.nodeConfig.conditionNodes[e])),this.drawer=!0},editTitle(){this.isEditTitle=!0,this.$nextTick((()=>{this.$refs.nodeTitle.focus()}))},saveTitle(){this.isEditTitle=!1},save(){this.nodeConfig.conditionNodes[this.index]=this.form,this.$emit("update:modelValue",this.nodeConfig),this.drawer=!1},addTerm(){let e=this.nodeConfig.conditionNodes.length+1;this.nodeConfig.conditionNodes.push({nodeName:"条件"+e,type:3,priorityLevel:e,conditionMode:1,conditionList:[]})},delTerm(e){this.nodeConfig.conditionNodes.splice(e,1),1==this.nodeConfig.conditionNodes.length&&(this.nodeConfig.childNode&&(this.nodeConfig.conditionNodes[0].childNode?this.reData(this.nodeConfig.conditionNodes[0].childNode,this.nodeConfig.childNode):this.nodeConfig.conditionNodes[0].childNode=this.nodeConfig.childNode),this.$emit("update:modelValue",this.nodeConfig.conditionNodes[0].childNode))},reData(e,l){e.childNode?this.reData(e.childNode,l):e.childNode=l},arrTransfer(e,l=1){this.nodeConfig.conditionNodes[e]=this.nodeConfig.conditionNodes.splice(e+l,1,this.nodeConfig.conditionNodes[e])[0],this.nodeConfig.conditionNodes.map(((e,l)=>{e.priorityLevel=l+1})),this.$emit("update:modelValue",this.nodeConfig)},addConditionList(){this.form.conditionList.push({label:"",field:"",operator:"=",value:""})},deleteConditionList(e){this.form.conditionList.splice(e,1)},toText(e,l){var{conditionList:o}=e.conditionNodes[l];if(o&&1==o.length){const e=o.map((e=>`${e.label}${e.operator}${e.value}`)).join(" 和 ");return e}if(o&&o.length>1){const t=1==e.conditionNodes[l].conditionMode?"且行":"或行";return o.length+"个条件，"+t}return l==e.conditionNodes.length-1&&"其他条件进入此流程"}}};const pe=(0,W.A)(ce,[["render",ue]]);var me=pe;const fe={class:"node-wrap"},ke={class:"title",style:{background:"#3296fa"}},ge={class:"content"},he={key:0},be={key:1,class:"placeholder"},Ce={class:"node-wrap-drawer__title"},ye={class:"tags-list"};function ve(e,l,o,d,i,a){const n=(0,t.g2)("el-icon-promotion"),s=(0,t.g2)("el-icon"),r=(0,t.g2)("el-icon-close"),p=(0,t.g2)("add-node"),m=(0,t.g2)("el-icon-edit"),f=(0,t.g2)("el-input"),k=(0,t.g2)("el-button"),g=(0,t.g2)("el-tag"),h=(0,t.g2)("el-form-item"),b=(0,t.g2)("el-checkbox"),C=(0,t.g2)("el-form"),y=(0,t.g2)("el-main"),v=(0,t.g2)("el-footer"),_=(0,t.g2)("el-container"),F=(0,t.g2)("el-drawer");return(0,t.uX)(),(0,t.CE)("div",fe,[(0,t.Lk)("div",{class:"node-wrap-box",onClick:l[1]||(l[1]=(...e)=>a.show&&a.show(...e))},[(0,t.Lk)("div",ke,[(0,t.bF)(s,{class:"icon"},{default:(0,t.k6)((()=>[(0,t.bF)(n)])),_:1}),(0,t.Lk)("span",null,(0,u.v_)(i.nodeConfig.nodeName),1),(0,t.bF)(s,{class:"close",onClick:l[0]||(l[0]=(0,c.D$)((e=>a.delNode()),["stop"]))},{default:(0,t.k6)((()=>[(0,t.bF)(r)])),_:1})]),(0,t.Lk)("div",ge,[a.toText(i.nodeConfig)?((0,t.uX)(),(0,t.CE)("span",he,(0,u.v_)(a.toText(i.nodeConfig)),1)):((0,t.uX)(),(0,t.CE)("span",be,"请选择人员"))])]),(0,t.bF)(p,{modelValue:i.nodeConfig.childNode,"onUpdate:modelValue":l[2]||(l[2]=e=>i.nodeConfig.childNode=e)},null,8,["modelValue"]),(0,t.bF)(F,{title:"抄送人设置",modelValue:i.drawer,"onUpdate:modelValue":l[8]||(l[8]=e=>i.drawer=e),"destroy-on-close":"","append-to-body":"",size:500},{header:(0,t.k6)((()=>[(0,t.Lk)("div",Ce,[i.isEditTitle?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("label",{key:0,onClick:l[3]||(l[3]=(...e)=>a.editTitle&&a.editTitle(...e))},[(0,t.eW)((0,u.v_)(i.form.nodeName),1),(0,t.bF)(s,{class:"node-wrap-drawer__title-edit"},{default:(0,t.k6)((()=>[(0,t.bF)(m)])),_:1})])),i.isEditTitle?((0,t.uX)(),(0,t.Wv)(f,{key:1,ref:"nodeTitle",modelValue:i.form.nodeName,"onUpdate:modelValue":l[4]||(l[4]=e=>i.form.nodeName=e),clearable:"",onBlur:a.saveTitle,onKeyup:(0,c.jR)(a.saveTitle,["enter"])},null,8,["modelValue","onBlur","onKeyup"])):(0,t.Q3)("",!0)])])),default:(0,t.k6)((()=>[(0,t.bF)(_,null,{default:(0,t.k6)((()=>[(0,t.bF)(y,{style:{padding:"0 20px 20px 20px"}},{default:(0,t.k6)((()=>[(0,t.bF)(C,{"label-position":"top"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{label:"选择要抄送的人员"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{type:"primary",icon:"el-icon-plus",round:"",onClick:l[5]||(l[5]=e=>a.selectHandle(1,i.form.nodeUserList))},{default:(0,t.k6)((()=>l[9]||(l[9]=[(0,t.eW)("选择人员")]))),_:1}),(0,t.Lk)("div",ye,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.form.nodeUserList,((e,l)=>((0,t.uX)(),(0,t.Wv)(g,{key:e.id,closable:"",onClose:e=>a.delUser(l)},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.name),1)])),_:2},1032,["onClose"])))),128))])])),_:1}),(0,t.bF)(h,{label:""},{default:(0,t.k6)((()=>[(0,t.bF)(b,{modelValue:i.form.userSelectFlag,"onUpdate:modelValue":l[6]||(l[6]=e=>i.form.userSelectFlag=e),label:"允许发起人自选抄送人"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(v,null,{default:(0,t.k6)((()=>[(0,t.bF)(k,{type:"primary",onClick:a.save},{default:(0,t.k6)((()=>l[10]||(l[10]=[(0,t.eW)("保存")]))),_:1},8,["onClick"]),(0,t.bF)(k,{onClick:l[7]||(l[7]=e=>i.drawer=!1)},{default:(0,t.k6)((()=>l[11]||(l[11]=[(0,t.eW)("取消")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var _e={inject:["select"],props:{modelValue:{type:Object,default:()=>{}}},components:{addNode:X},data(){return{nodeConfig:{},drawer:!1,isEditTitle:!1,form:{}}},watch:{modelValue(){this.nodeConfig=this.modelValue}},mounted(){this.nodeConfig=this.modelValue},methods:{show(){this.form={},this.form=JSON.parse(JSON.stringify(this.nodeConfig)),this.drawer=!0},editTitle(){this.isEditTitle=!0,this.$nextTick((()=>{this.$refs.nodeTitle.focus()}))},saveTitle(){this.isEditTitle=!1},save(){this.$emit("update:modelValue",this.form),this.drawer=!1},delNode(){this.$emit("update:modelValue",this.nodeConfig.childNode)},delUser(e){this.form.nodeUserList.splice(e,1)},selectHandle(e,l){this.select(e,l)},toText(e){if(e.nodeUserList&&e.nodeUserList.length>0){const l=e.nodeUserList.map((e=>e.name)).join("、");return l}return!!e.userSelectFlag&&"发起人自选"}}};const Fe=(0,W.A)(_e,[["render",ve]]);var Ve=Fe,Le={props:{modelValue:{type:Object,default:()=>{}}},components:{approver:Q,promoter:P,branch:me,send:Ve},data(){return{nodeConfig:{}}},watch:{modelValue(e){this.nodeConfig=e},nodeConfig(e){this.$emit("update:modelValue",e)}},mounted(){this.nodeConfig=this.modelValue},methods:{}};const we=(0,W.A)(Le,[["render",r]]);var Ne=we;const Te={key:0,class:"sc-user-select"},Ue={class:"sc-user-select__left"},We={class:"sc-user-select__search"},xe={class:"sc-user-select__select"},Xe={class:"sc-user-select__tree"},Ee={class:"sc-user-select__user"},$e={class:"sc-user-select__user__list"},Qe={class:"sc-user-select__toicon"},Se={class:"sc-user-select__selected"},Me={class:"name"},Re={class:"delete"},je={key:1,class:"sc-user-select sc-user-select-role"},Oe={class:"sc-user-select__left"},Ie={class:"sc-user-select__select"},Ke={class:"sc-user-select__tree"},Ae={class:"sc-user-select__toicon"},Pe={class:"sc-user-select__selected"},ze={class:"name"},De={class:"delete"};function Je(e,l,o,d,i,a){const n=(0,t.g2)("el-button"),s=(0,t.g2)("el-input"),r=(0,t.g2)("el-tree"),c=(0,t.g2)("el-scrollbar"),p=(0,t.g2)("el-pagination"),m=(0,t.g2)("el-icon-arrow-right"),f=(0,t.g2)("el-icon"),k=(0,t.g2)("el-avatar"),g=(0,t.g2)("el-dialog"),h=(0,t.gN)("loading");return(0,t.uX)(),(0,t.Wv)(g,{modelValue:i.dialogVisible,"onUpdate:modelValue":l[3]||(l[3]=e=>i.dialogVisible=e),title:i.titleMap[i.type-1],width:1==i.type?680:460,"destroy-on-close":"","append-to-body":"",onClosed:l[4]||(l[4]=l=>e.$emit("closed"))},{footer:(0,t.k6)((()=>[(0,t.bF)(n,{onClick:l[2]||(l[2]=e=>i.dialogVisible=!1)},{default:(0,t.k6)((()=>l[5]||(l[5]=[(0,t.eW)("取 消")]))),_:1}),(0,t.bF)(n,{type:"primary",onClick:a.save},{default:(0,t.k6)((()=>l[6]||(l[6]=[(0,t.eW)("确 认")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[1==i.type?((0,t.uX)(),(0,t.CE)("div",Te,[(0,t.Lk)("div",Ue,[(0,t.Lk)("div",We,[(0,t.bF)(s,{modelValue:i.keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>i.keyword=e),"prefix-icon":"el-icon-search",placeholder:"搜索成员"},{append:(0,t.k6)((()=>[(0,t.bF)(n,{icon:"el-icon-search",onClick:a.search},null,8,["onClick"])])),_:1},8,["modelValue"])]),(0,t.Lk)("div",xe,[(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",Xe,[(0,t.bF)(c,null,{default:(0,t.k6)((()=>[(0,t.bF)(r,{class:"menu",ref:"groupTree",data:i.group,"node-key":i.groupProps.key,props:i.groupProps,"highlight-current":"","expand-on-click-node":!1,"current-node-key":i.groupId,onNodeClick:a.groupClick},null,8,["data","node-key","props","current-node-key","onNodeClick"])])),_:1})])),[[h,i.showGrouploading]]),(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",Ee,[(0,t.Lk)("div",$e,[(0,t.bF)(c,{ref:"userScrollbar"},{default:(0,t.k6)((()=>[(0,t.bF)(r,{class:"menu",ref:"userTree",data:i.user,"node-key":i.userProps.key,props:i.userProps,"default-checked-keys":a.selectedIds,"show-checkbox":"","check-on-click-node":"",onCheckChange:a.userClick},null,8,["data","node-key","props","default-checked-keys","onCheckChange"])])),_:1},512)]),(0,t.Lk)("footer",null,[(0,t.bF)(p,{background:"",layout:"prev,next",small:"",total:i.total,"page-size":i.pageSize,currentPage:i.currentPage,"onUpdate:currentPage":l[1]||(l[1]=e=>i.currentPage=e),onCurrentChange:a.paginationChange},null,8,["total","page-size","currentPage","onCurrentChange"])])])),[[h,i.showUserloading]])])]),(0,t.Lk)("div",Qe,[(0,t.bF)(f,null,{default:(0,t.k6)((()=>[(0,t.bF)(m)])),_:1})]),(0,t.Lk)("div",Se,[(0,t.Lk)("header",null,"已选 ("+(0,u.v_)(i.selected.length)+")",1),(0,t.Lk)("ul",null,[(0,t.bF)(c,null,{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.selected,((e,l)=>((0,t.uX)(),(0,t.CE)("li",{key:e.id},[(0,t.Lk)("span",Me,[(0,t.bF)(k,{size:"small"},{default:(0,t.k6)((()=>[(0,t.eW)((0,u.v_)(e.name.substring(0,1)),1)])),_:2},1024),(0,t.Lk)("label",null,(0,u.v_)(e.name),1)]),(0,t.Lk)("span",Re,[(0,t.bF)(n,{type:"danger",icon:"el-icon-delete",circle:"",size:"small",onClick:e=>a.deleteSelected(l)},null,8,["onClick"])])])))),128))])),_:1})])])])):(0,t.Q3)("",!0),2==i.type?((0,t.uX)(),(0,t.CE)("div",je,[(0,t.Lk)("div",Oe,[(0,t.Lk)("div",Ie,[(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",Ke,[(0,t.bF)(c,null,{default:(0,t.k6)((()=>[(0,t.bF)(r,{class:"menu",ref:"groupTree",data:i.role,"node-key":i.roleProps.key,props:i.roleProps,"show-checkbox":"","check-strictly":"","check-on-click-node":"","expand-on-click-node":!1,"default-checked-keys":a.selectedIds,onCheckChange:a.roleClick},null,8,["data","node-key","props","default-checked-keys","onCheckChange"])])),_:1})])),[[h,i.showGrouploading]])])]),(0,t.Lk)("div",Ae,[(0,t.bF)(f,null,{default:(0,t.k6)((()=>[(0,t.bF)(m)])),_:1})]),(0,t.Lk)("div",Pe,[(0,t.Lk)("header",null,"已选 ("+(0,u.v_)(i.selected.length)+")",1),(0,t.Lk)("ul",null,[(0,t.bF)(c,null,{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.selected,((e,l)=>((0,t.uX)(),(0,t.CE)("li",{key:e.id},[(0,t.Lk)("span",ze,[(0,t.Lk)("label",null,(0,u.v_)(e.name),1)]),(0,t.Lk)("span",De,[(0,t.bF)(n,{type:"danger",icon:"el-icon-delete",circle:"",size:"small",onClick:e=>a.deleteSelected(l)},null,8,["onClick"])])])))),128))])),_:1})])])])):(0,t.Q3)("",!0)])),_:1},8,["modelValue","title","width"])}var Be=o(1552),Ge={successCode:200,group:{apiObj:Be.A.system.dept.list,parseData:function(e){return{rows:e.data,msg:e.message,code:e.code}},props:{key:"id",label:"label",children:"children"}},user:{apiObj:Be.A.demo.page,pageSize:20,parseData:function(e){return{rows:e.data.rows,total:e.data.total,msg:e.message,code:e.code}},props:{key:"id",label:"user"},request:{page:"page",pageSize:"pageSize",groupId:"groupId",keyword:"keyword"}},role:{apiObj:Be.A.system.dept.list,parseData:function(e){return{rows:e.data,msg:e.message,code:e.code}},props:{key:"id",label:"label",children:"children"}}},He={props:{modelValue:{type:Boolean,default:!1}},data(){return{groupProps:Ge.group.props,userProps:Ge.user.props,roleProps:Ge.role.props,titleMap:["人员选择","角色选择"],dialogVisible:!1,showGrouploading:!1,showUserloading:!1,keyword:"",groupId:"",pageSize:Ge.user.pageSize,total:0,currentPage:1,group:[],user:[],role:[],type:1,selected:[],value:[]}},computed:{selectedIds(){return this.selected.map((e=>e.id))}},mounted(){},methods:{open(e,l){this.type=e,this.value=l||[],this.selected=JSON.parse(JSON.stringify(l||[])),this.dialogVisible=!0,1==this.type?(this.getGroup(),this.getUser()):2==this.type&&this.getRole()},async getGroup(){this.showGrouploading=!0;var e=await Ge.group.apiObj.get();this.showGrouploading=!1;var l={[Ge.group.props.key]:"",[Ge.group.props.label]:"所有"};e.data.unshift(l),this.group=Ge.group.parseData(e).rows},async getUser(){this.showUserloading=!0;var e={[Ge.user.request.keyword]:this.keyword||null,[Ge.user.request.groupId]:this.groupId||null,[Ge.user.request.page]:this.currentPage,[Ge.user.request.pageSize]:this.pageSize},l=await Ge.user.apiObj.get(e);this.showUserloading=!1,this.user=Ge.user.parseData(l).rows,this.total=Ge.user.parseData(l).total||0,this.$refs.userScrollbar.setScrollTop(0)},async getRole(){this.showGrouploading=!0;var e=await Ge.role.apiObj.get();this.showGrouploading=!1,this.role=Ge.role.parseData(e).rows},groupClick(e){this.keyword="",this.currentPage=1,this.groupId=e[Ge.group.props.key],this.getUser()},userClick(e,l){l?this.selected.push({id:e[Ge.user.props.key],name:e[Ge.user.props.label]}):this.selected=this.selected.filter((l=>l.id!=e[Ge.user.props.key]))},paginationChange(){this.getUser()},search(){this.groupId="",this.$refs.groupTree.setCurrentKey(this.groupId),this.currentPage=1,this.getUser()},deleteSelected(e){this.selected.splice(e,1),1==this.type?this.$refs.userTree.setCheckedKeys(this.selectedIds):2==this.type&&this.$refs.groupTree.setCheckedKeys(this.selectedIds)},roleClick(e,l){l?this.selected.push({id:e[Ge.role.props.key],name:e[Ge.role.props.label]}):this.selected=this.selected.filter((l=>l.id!=e[Ge.role.props.key]))},save(){this.value.splice(0,this.value.length),this.selected.map((e=>{this.value.push(e)})),this.dialogVisible=!1}}};const qe=(0,W.A)(He,[["render",Je],["__scopeId","data-v-e3061d58"]]);var Ye=qe,Ze={provide(){return{select:this.selectHandle}},props:{modelValue:{type:Object,default:()=>{}}},components:{nodeWrap:Ne,useSelect:Ye},data(){return{nodeConfig:this.modelValue,selectVisible:!1}},watch:{modelValue(e){this.nodeConfig=e},nodeConfig(e){this.$emit("update:modelValue",e)}},mounted(){},methods:{selectHandle(e,l){this.selectVisible=!0,this.$nextTick((()=>{this.$refs.useselect.open(e,l)}))}}};const el=(0,W.A)(Ze,[["render",s]]);var ll=el,ol={name:"workflow",components:{scWorkflow:ll},data(){return{data:{id:1,name:"请假审批",nodeConfig:{nodeName:"发起人",type:0,nodeRoleList:[],childNode:{nodeName:"条件路由",type:4,conditionNodes:[{nodeName:"长期",type:3,priorityLevel:1,conditionMode:1,conditionList:[{label:"请假天数",field:"day",operator:">",value:"7"}],childNode:{nodeName:"领导审批",type:1,setType:1,nodeUserList:[{id:"360000197302144442",name:"何敏"}],nodeRoleList:[],examineLevel:1,directorLevel:1,selectMode:1,termAuto:!1,term:0,termMode:1,examineMode:1,directorMode:0}},{nodeName:"短期",type:3,priorityLevel:2,conditionMode:1,conditionList:[],childNode:{nodeName:"直接主管审批",type:1,setType:2,nodeUserList:[],nodeRoleList:[],examineLevel:1,directorLevel:1,selectMode:1,termAuto:!1,term:0,termMode:1,examineMode:1,directorMode:0}}],childNode:{nodeName:"抄送人",type:2,userSelectFlag:!0,nodeUserList:[{id:"220000200908305857",name:"何秀英"}]}}}}}},mounted(){},methods:{exportJson(){this.$message("返回值请查看F12控制台console.log()"),console.log(this.data)}}};const tl=(0,W.A)(ol,[["render",i]]);var dl=tl}}]);